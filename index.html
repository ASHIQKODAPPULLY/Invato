<!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Saveroo - Smart Grocery Price Comparison</title>
      <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
      <style>
        :root {
          --primary-color: #8B5CF6;
          --secondary-color: #10B981;
          --background-color: #F3F4F6;
          --card-background: #ffffff;
          --text-color: #1F2937;
          --border-radius: 16px;
          --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
          --hover-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: 'Inter', sans-serif;
          background-color: var(--background-color);
          color: var(--text-color);
          line-height: 1.6;
          padding: 2rem;
        }

        h1, h2, h3, .brand-name {
          font-family: 'Space Grotesk', sans-serif;
        }

        .logo-container {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 1.5rem;
          margin-bottom: 2rem;
          position: relative;
        }

        .logo {
          width: 5rem;
          height: 5rem;
          position: relative;
          display: flex;
          align-items: center;
          justify-content: center;
          transform: translateY(0);
          animation: float 3s ease-in-out infinite;
          filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
        }

        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }

        .logo svg {
          width: 100%;
          height: 100%;
        }

        .logo path {
          fill: url(#logo-gradient);
        }

        .logo-cart {
          position: absolute;
          font-size: 1.5rem;
          right: -0.5rem;
          bottom: 0.2rem;
          color: var(--secondary-color);
          filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1));
          transform-origin: bottom center;
          animation: wobble 3s ease-in-out infinite;
        }

        @keyframes wobble {
          0%, 100% { transform: rotate(0deg); }
          25% { transform: rotate(-5deg); }
          75% { transform: rotate(5deg); }
        }

        .brand-name {
          font-size: 3.2rem;
          font-weight: 700;
          color: var(--primary-color);
          letter-spacing: -1px;
        }

        .brand-name span {
          color: var(--secondary-color);
        }

        .header {
          text-align: center;
          margin-bottom: 3rem;
          padding: 3rem;
          background: var(--card-background);
          border-radius: var(--border-radius);
          box-shadow: var(--shadow);
          transition: all 0.3s ease;
        }

        .header:hover {
          box-shadow: var(--hover-shadow);
          transform: translateY(-2px);
        }

        .header h1 {
          color: var(--primary-color);
          font-size: 2.8rem;
          margin-bottom: 1rem;
          line-height: 1.2;
        }

        .header p {
          color: #64748b;
          font-size: 1.25rem;
          max-width: 700px;
          margin: 0 auto;
        }

        .features {
          display: flex;
          justify-content: center;
          gap: 3rem;
          margin-top: 2rem;
        }

        .feature {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          color: #64748b;
          font-size: 1.1rem;
        }

        .feature i {
          color: var(--primary-color);
          font-size: 1.4rem;
        }

        .container {
          max-width: 1600px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(700px, 1fr));
          gap: 3rem;
        }

        .section {
          background: var(--card-background);
          padding: 2.5rem;
          border-radius: var(--border-radius);
          box-shadow: var(--shadow);
          transition: all 0.3s ease;
        }

        .section:hover {
          box-shadow: var(--hover-shadow);
        }

        .section h2 {
          color: var(--primary-color);
          margin-bottom: 2rem;
          display: flex;
          align-items: center;
          gap: 0.75rem;
          font-size: 1.8rem;
        }

        .search-box {
          display: flex;
          gap: 1rem;
          margin-bottom: 2rem;
        }

        input[type="text"] {
          flex: 1;
          padding: 1rem 1.5rem;
          border: 2px solid #e2e8f0;
          border-radius: var(--border-radius);
          font-size: 1.1rem;
          transition: all 0.3s ease;
          font-family: 'Inter', sans-serif;
        }

        input[type="text"]:focus {
          outline: none;
          border-color: var(--primary-color);
          box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        button {
          padding: 1rem 2rem;
          background-color: var(--primary-color);
          color: white;
          border: none;
          border-radius: var(--border-radius);
          cursor: pointer;
          font-weight: 500;
          display: flex;
          align-items: center;
          gap: 0.75rem;
          transition: all 0.3s ease;
          font-family: 'Inter', sans-serif;
          font-size: 1.1rem;
        }

        button:hover {
          background-color: #4f46e5;
          transform: translateY(-2px);
          box-shadow: var(--shadow);
        }

        .product-card {
          background: #f8fafc;
          padding: 2rem;
          border-radius: var(--border-radius);
          margin: 1.5rem 0;
          border: 1px solid #e2e8f0;
          transition: all 0.3s ease;
        }

        .product-card:hover {
          transform: translateY(-3px);
          box-shadow: var(--hover-shadow);
        }

        .product-card h3 {
          color: var(--text-color);
          font-size: 1.5rem;
          margin-bottom: 1rem;
        }

        .price-comparison {
          background: #ffffff;
          padding: 1.25rem;
          margin: 0.75rem 0;
          border-radius: var(--border-radius);
          border: 1px solid #e2e8f0;
          transition: all 0.2s ease;
        }

        .price-comparison:hover {
          border-color: var(--primary-color);
          transform: translateX(5px);
        }

        .best-price {
          color: var(--secondary-color);
          font-weight: 600;
          font-size: 1.1rem;
        }

        .shopping-list {
          list-style: none;
          margin-top: 1.5rem;
        }

        .shopping-list li {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 1.25rem;
          margin: 0.75rem 0;


          background: #f8fafc;
          border-radius: var(--border-radius);
          border: 1px solid #e2e8f0;
          transition: all 0.3s ease;
          font-size: 1.1rem;
        }

        .shopping-list li:hover {
          transform: translateX(5px);
          border-color: var(--primary-color);
          box-shadow: var(--shadow);
        }

        .remove-item {
          background-color: #ef4444;
          padding: 0.75rem 1.25rem;
          font-size: 1rem;
        }

        .remove-item:hover {
          background-color: #dc2626;
        }

        .total-section {
          margin-top: 2.5rem;
          padding: 2rem;
          background: #f8fafc;
          border-radius: var(--border-radius);
          border: 1px solid #e2e8f0;
        }

        .total-section h3 {
          color: var(--text-color);
          font-size: 1.5rem;
          margin-bottom: 1.5rem;
        }

        .store-total {
          display: flex;
          justify-content: space-between;
          padding: 1.25rem;
          margin: 0.75rem 0;
          background: white;
          border-radius: var(--border-radius);
          transition: all 0.3s ease;
          font-size: 1.1rem;
        }

        .store-total:hover {
          transform: scale(1.02);
          box-shadow: var(--shadow);
        }

        .best-total {
          color: var(--secondary-color);
          font-weight: 600;
          background: #f0fdf4;
        }

        .last-updated {
          font-size: 0.9rem;
          color: #64748b;
          margin-top: 0.75rem;
        }

        @media (max-width: 1400px) {
          .container {
            grid-template-columns: 1fr;
          }
          
          .section {
            margin: 0 auto;
            max-width: 800px;
          }
        }

        @media (max-width: 768px) {
          body {
            padding: 1rem;
          }

          .header {
            padding: 2rem 1rem;
          }

          .features {
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
          }

          .section {
            padding: 1.5rem;
          }
        }

        /* Animations */
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }

        .product-card, .shopping-list li {
          animation: fadeIn 0.3s ease-out;
        }
      </style>
    </head>
    <body>
      <div class="logo-container">
        <div class="logo">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="logo-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:var(--primary-color)" />
                <stop offset="100%" style="stop-color:var(--secondary-color)" />
              </linearGradient>
            </defs>
            <path d="M50 15
                     c-15 0-25 10-25 25
                     c0 10 5 17.5 12.5 25
                     c7.5 7.5 12.5 15 12.5 30
                     c0-15 5-22.5 12.5-30
                     c7.5-7.5 12.5-15 12.5-25
                     c0-15-10-25-25-25z
                     M42 35
                     c0 4.4 3.6 8 8 8
                     c4.4 0 8-3.6 8-8
                     c0-4.4-3.6-8-8-8
                     c-4.4 0-8 3.6-8 8z
                     M35 50
                     c-2.5-5-7.5-5-10 0
                     c-2.5 5 0 10 5 10
                     c5 0 7.5-5 5-10z
                     M65 50
                     c2.5-5 7.5-5 10 0
                     c2.5 5 0 10-5 10
                     c-5 0-7.5-5-5-10z"/>
          </svg>
          <i class="fas fa-shopping-cart logo-cart"></i>
        </div>
        <div class="brand-name">Saver<span>oo</span></div>
      </div>
      
      <header class="header">
        <h1>Smart Grocery Price Comparison</h1>
        <p>Compare prices across Woolworths, Coles, and Aldi to find the best deals on your groceries</p>
        <div class="features">
          <div class="feature">
            <i class="fas fa-search"></i>
            <span>Real-time Price Comparison</span>
          </div>
          <div class="feature">
            <i class="fas fa-shopping-cart"></i>
            <span>Shopping List Builder</span>
          </div>
          <div class="feature">
            <i class="fas fa-piggy-bank"></i>
            <span>Save Money</span>
          </div>
        </div>
      </header>
      
      <div class="container">
        <div class="section">
          <h2><i class="fas fa-search"></i> Search Products</h2>
          <div class="search-box">
            <input type="text" id="searchInput" placeholder="Enter product name...">
            <button onclick="searchProducts()">
              <i class="fas fa-search"></i> Search
            </button>
          </div>
          <div id="searchResults"></div>
        </div>
        
        <div class="section">
          <h2><i class="fas fa-shopping-cart"></i> Shopping List</h2>
          <div class="search-box">
            <input type="text" id="addItemInput" placeholder="Add item to list...">
            <button onclick="addToList()">
              <i class="fas fa-plus"></i> Add
            </button>
          </div>
          <ul id="shoppingList" class="shopping-list"></ul>
          
          <div class="total-section">
            <h3><i class="fas fa-calculator"></i> Total Cost Comparison</h3>
            <div id="totalComparison"></div>
          </div>
        </div>
      </div>

      <script>
        let shoppingListItems = [];

        async function searchProducts() {
          const searchTerm = document.getElementById('searchInput').value;
          if (!searchTerm) return;

          try {
            const response = await fetch(`/api/prices?product=${encodeURIComponent(searchTerm)}`);
            const prices = await response.json();
            displaySearchResults(searchTerm, prices);
          } catch (error) {
            console.error('Error searching products:', error);
            alert('Error searching products. Please try again.');
          }
        }

        function displaySearchResults(searchTerm, prices) {
          const resultsDiv = document.getElementById('searchResults');
          resultsDiv.innerHTML = '';

          if (Object.keys(prices).length === 0) {
            resultsDiv.innerHTML = '<p>No products found.</p>';
            return;
          }

          const productCard = document.createElement('div');
          productCard.className = 'product-card';

          let bestPrice = Infinity;
          let bestStore = '';

          Object.entries(prices).forEach(([store, data]) => {
            if (data.price < bestPrice) {
              bestPrice = data.price;
              bestStore = store;
            }
          });

          let html = `<h3>${searchTerm}</h3>`;
          Object.entries(prices).forEach(([store, data]) => {
            const priceClass = store === bestStore ? 'best-price' : '';
            html += `
              <div class="price-comparison">
                <span class="${priceClass}">
                  <i class="fas fa-store"></i> ${store}: $${data.price.toFixed(2)}
                  ${store === bestStore ? '<i class="fas fa-crown"></i>' : ''}
                </span>
                <div class="last-updated">
                  <i class="fas fa-clock"></i> Last updated: ${new Date(data.last_updated).toLocaleString()}
                </div>
              </div>
            `;
          });

          html += `
            <button onclick="addToList('${searchTerm}')">
              <i class="fas fa-plus"></i> Add to List
            </button>
          `;
          productCard.innerHTML = html;
          resultsDiv.appendChild(productCard);
        }

        function addToList(productName = '') {
          const input = document.getElementById('addItemInput');
          const name = productName || input.value.trim();
          
          if (!name) return;

          shoppingListItems.push(name);
          updateShoppingList();
          updateTotalComparison();

          input.value = '';
        }

        function removeFromList(index) {
          shoppingListItems.splice(index, 1);
          updateShoppingList();
          updateTotalComparison();
        }

        function updateShoppingList() {
          const list = document.getElementById('shoppingList');
          list.innerHTML = '';

          shoppingListItems.forEach((item, index) => {
            const li = document.createElement('li');
            li.innerHTML = `
              <span><i class="fas fa-shopping-basket"></i> ${item}</span>
              <button class="remove-item" onclick="removeFromList(${index})">
                <i class="fas fa-trash"></i> Remove
              </button>
            `;
            list.appendChild(li);
          });
        }

        async function updateTotalComparison() {
          if (shoppingListItems.length === 0) {
            document.getElementById('totalComparison').innerHTML = '';
            return;
          }

          try {
            const response = await fetch(`/api/cart-total?products=${JSON.stringify(shoppingListItems)}`);
            const data = await response.json();

            let html = '';
            Object.entries(data.totals).forEach(([store, total]) => {
              const isBest = store === data.best_value;
              html += `
                <div class="store-total ${isBest ? 'best-total' : ''}">
                  <span>
                    <i class="fas fa-store"></i> ${store}
                    ${isBest ? '<i class="fas fa-crown"></i>' : ''}
                  </span>
                  <span>$${total.toFixed(2)}</span>
                </div>
              `;
            });

            const savings = Math.max(...Object.values(data.totals)) - Math.min(...Object.values(data.totals));
            html += `
              <div style="margin-top: 1rem; font-weight: bold; text-align: center;">
                <i class="fas fa-piggy-bank"></i> Best Value: ${data.best_value}
                <br>
                <span style="color: var(--secondary-color);">
                  You save $${savings.toFixed(2)}
                </span>
              </div>
            `;

            document.getElementById('totalComparison').innerHTML = html;
          } catch (error) {
            console.error('Error updating totals:', error);
          }
        }

        // Add enter key support
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
          if (e.key === 'Enter') searchProducts();
        });

        document.getElementById('addItemInput').addEventListener('keypress', (e) => {
          if (e.key === 'Enter') addToList();
        });
      </script>
    </body>
    </html>

